"use strict";(()=>{var s=document.getElementById("drawingCanvas-dark"),l=s.getContext("2d");l.strokeStyle="black";var h=document.getElementById("drawingCanvas-light"),u=h.getContext("2d");u.strokeStyle="white";var g=!1,C,I;l.lineWidth=15;l.lineCap="round";u.lineWidth=15;l.lineCap="round";var P=document.getElementById("base64Image-dark"),_=document.getElementById("base64Image-light");function T(e,o=!1){let n=s.getBoundingClientRect(),t=s.width/n.width,i=s.height/n.height,a=(o?e.touches[0].clientX:e.clientX)-n.left,r=(o?e.touches[0].clientY:e.clientY)-n.top;return{offsetX:a*t,offsetY:r*i}}function E(e,o=!1){g=!0,B(!0);let{offsetX:n,offsetY:t}=T(e,o);l.beginPath(),l.moveTo(n,t)}function S(e,o=!1){if(!g)return;let{offsetX:n,offsetY:t}=T(e,o);l.lineTo(n,t),l.stroke(),u.lineTo(n,t),u.stroke()}function L(){g&&(g=!1,C=s.toDataURL(),I=h.toDataURL())}function B(e){$("#createBtn").toggleClass("disabled",!e),$("#canvas-embed").toggleClass("active",e)}s.addEventListener("mousedown",E);s.addEventListener("mousemove",S);s.addEventListener("mouseup",L);s.addEventListener("touchstart",e=>{e.preventDefault(),E(e,!0)},{passive:!1});s.addEventListener("touchmove",e=>{e.preventDefault(),S(e,!0)},{passive:!1});s.addEventListener("touchend",L);$("#createBtn").on("click",async function(){$(this).addClass("disabled");var e=".",o=$(this),n=setInterval(function(){e=e.length<3?e+".":".",o.text("Submitting"+e)},500);let t=async i=>{try{let a=await fetch("https://api.zdenek.design/api/upload",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({base64:i})});if(!a.ok){let p=await a.text();throw console.error("Server responded with an error:",p),new Error(`HTTP error! status: ${a.status}`)}return await a.json()}catch(a){console.error(`There was a problem with the fetch operation: ${a.message}`),a.stack&&console.error(a.stack)}};Promise.all([t(C),t(I)]).then(([i,a])=>{console.log("Dark image data:",i.url),console.log("Light image data:",a.url),P.value="",_.value="",$('[name="img-source-dark"').val(i.url),$('[name="img-source-light"').val(a.url),$("#submitBtn").trigger("click"),$(document).ajaxComplete(function(r,p,b){if(b.url.includes("https://webflow.com/api/v1/form/")){let R=p.status===200,M="note-form",Y=b.data.includes(M);R&&(clearInterval(n),X(),setTimeout(()=>{window.location.reload()},5e3))}})}).catch(i=>console.log("Caught an error:",i))});$(".plg-note_item.button-item").on("click",function(){$("html,body").addClass("overflow-hidden")});$("[close-note]").on("click",function(){l.clearRect(0,0,s.width,s.height),u.clearRect(0,0,h.width,h.height),B(!1),$("html,body").removeClass("overflow-hidden")});var c=".plg-modal",v=".plg-modal_content",w=".plg-modal_slider";var m,f=!1,d=!1,k;$(".plg-visuals_visual").on("click",function(){let e=$(this),o=e.find(".name").val(),n=e.find(".slug").val();$(v).empty();let t=gsap.timeline();t.set(c,{opacity:0}),t.to(c,{opacity:1,display:"block"}),$(v).load("/playground-items/"+n+" .plg-modal_slider",function(){f=!0,d&&(m.destroy(!0,!0),d=!1),D(),y(w),$(".plg-modal_head-inner p").text(o);let i=$(c).find(".plg-modal_item-1");gsap.timeline().from(i,{y:"2rem",opacity:0,stagger:{each:.2}}),window.matchMedia("(min-width: 0px) and (max-width: 991px)").matches&&$(v).find("video").each(function(){var r=$(this)[0];r.load(),r.muted=!0,r.oncanplaythrough=function(){r.play()}})})});function y(e){let o=window.matchMedia("(min-width: 0px) and (max-width: 991px)"),n=window.matchMedia("(min-width: 992px)");f&&(n.matches?d||(d=!0,m=new Swiper(e,{slidesPerView:"auto",spaceBetween:48,speed:500,observer:!0,mousewheel:{thresholdDelta:35},keyboard:{enabled:!0},longSwipesRatio:.01,on:{slideChange:t=>{x($(".swiper-wrapper"),t.realIndex)},init:t=>{x($(".swiper-wrapper"),t.realIndex)},onRealIndexChange:t=>{t.allowTouchMove=!1,t.unsetGrabCursor()},onTouchEnd:t=>{t.allowTouchMove=!0}}})):o.matches&&d&&(m.destroy(!0,!0),d=!1))}window.addEventListener("load",function(){y(w)});window.addEventListener("resize",function(){y(w)});var x=(e,o)=>{let n=$(e).find("[visual-video]").not(".w-condition-invisible"),i=$(e).find(".swiper-slide").eq(o);console.log(n),n.each(function(){$(this).find("video")[0].pause(),$(this).find("video")[0].currentTime=0});let a=i.find(n).find("video")[0];console.log(a),a&&a.play()};$("#modalClose").on("click",function(){f=!1,D();let e=gsap.timeline(),o=$(c).find(".plg-modal_item-1");e.to(o,{y:"2rem",opacity:0,stagger:{each:.2},duration:.3}),e.to(c,{opacity:0,duration:.3},"<"),e.set(c,{display:"none"},"<"),m&&m.destroy()});document.addEventListener("keydown",function(e){f===!0&&e.keyCode===27&&$("#modalClose").click()});var D=()=>{f?(k=$(window).scrollTop(),$("html, body").scrollTop(0).addClass("overflow-hidden")):$("html, body").scrollTop(k).removeClass("overflow-hidden")};function X(){var e=0,o=["Optimizing for Nokia3310...","Optimizing for IE6...","Minions work hard to save your brilliant massage...","Optimizing for Apple Watch...","Summoning loading minions...","Polishing pixels, one by one...","Unleashing loading ninjas...","Summoning loading unicorns...","This 5s is for you, breathe in, breathe out...","5s can be long right?...","Tap your screen three times and whisper 'loading' for a faster results..","Patient bring results...","Just a second, I have to start up my windows..."];$("#rotateBox").addClass("spin"),o.sort(()=>Math.random()-.5);var n=0,t=setInterval(function(){$("#text-help").text(o[n]),n++,n===o.length&&clearInterval(t)},1e3),i=5,a=setInterval(function(){i--,$("#countdownText").text(i),i===0&&clearInterval(a)},1e3)}})();
